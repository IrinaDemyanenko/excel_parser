# excel_parser
Технологии: pandas, openpyxl, python

Перед Вами проект, который обрабатывает Excel-файл, содержащий разичные технические данные, и преобразует его в файл JSON.

Порядок этапов:

1. preprocessor.py

Предобработка Excel-файла (из директории excel_parser_project/data/raw/имя_файла): очистка ячеек с числовыми данными от лишнего текста (например, "600 op.h.") и сохранение копии Excel-файла в той же директории, но с окончанием _cleaned.xlsx.

2. loader.py

Загрузка Excel-файла в Pandas без чёткого указания типов.

3. inspector.py

Быстрая оценка загруженной таблицы: вывод общей структуры таблицы, типов и первых строк для визуальной проверки.

4. cleaner.py

Общая очистка таблицы: удаление пробелов, прочерков ('-', '---') и замена их на pd.NA и удаление в ячейках, содержащих строки, символов переноса строки ('/n' меняем на ' ').

5. converter.py

Преобразование типов данных:
- числовые поля - Int64,
- даты - datetime64[ns],
- строки - string,
- числовые поля с ведущими нулями сохраняются в виде строк,
- колонку со смешанными данными (Float64 и string) делим на две колонки.

6. inspector.py

Вывод общей структуры таблицы, типов и первых строк для визуальной проверки.

7. exporter.py

Экспорт очищенной и преобразованной таблицы в JSON (list[dict] - массив объектов, где каждая строка - отдельный объект):

[
    {...},
    {...},
    ...
    {...}
]

Файл config.py содержит имена файлов и настройки путей - откуда взять файл для обработки и куда потом сохранить новый файл, с обработанной информацией. Такое размещение позволяет менять настройки в одном месте, что очень удобно.

### Как запустить проект:

1. Клонируйте репозиторий и перейдите в него в командной строке:

```
git clone https://github.com/IrinaDemyanenko/excel_parser.git
```

```
cd excel_parser/excel_parser_project/
```

2. Создайте виртуальное окружение и активируйте его:

```
python -m venv venv
venv/Scripts/activate
```

3. Установите зависимости:
```
pip install -r requirements.txt
```

4. Запустите скрипт для подготовки файла-excel. Выполнение скрипта создаст копию файла в директории excel_parser_project/data/raw/:
```
python prepare.py
```

5. Откройте копию файла в папке, сохраните изменения,  закройте файл. Этот шаг необходим для расчёта формул внутри файла-excel и получения вычисленных значений формул.

6. Теперь можно запускать основной скрипт:
```
python main.py
```

7. Итоговый .json-файл будет расположен в директории excel_parser_project/data/processed/json/.
